#!/bin/sh
if which realpath > /dev/null; then
  true
else 
  realpath() {
    OURPWD=$PWD
    cd "$(dirname "$1")"
    LINK=$(readlink "$(basename "$1")")
    while [ "$LINK" ]; do
      cd "$(dirname "$LINK")"
      LINK=$(readlink "$(basename "$1")")
    done
    REALPATH="$PWD/$(basename "$1")"
    cd "$OURPWD"
    echo "$REALPATH"
  }
fi

me=$(realpath "$0")
program=$(basename "$me")
installation=$(dirname "$(dirname "$me")")
executable=$installation/usr/bin/$program
if [ -x "$executable" ] ; then
  case $1 in
    abort|auth|create|help|remove|retry|start|stop|upgrade|version)
      exec "$executable" "$@"
      ;;
    *)
      exec "$executable" --server.arangod="$installation/usr/sbin/arangod" --server.js-dir="$installation/usr/share/arangodb3/js" "$@"
      ;;
  esac
fi
echo "Could not find executable!"
exit 1
